[{"path":"https://vandenman.github.io/bgms/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Maarten Marsman. Maintainer.","code":""},{"path":"https://vandenman.github.io/bgms/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Marsman M (2023). bgms: Bayesian variable selection networks binary /ordinal variables. R package version 0.1.0.","code":"@Manual{,   title = {bgms: Bayesian variable selection for networks of binary and/or ordinal variables},   author = {Maarten Marsman},   year = {2023},   note = {R package version 0.1.0}, }"},{"path":"https://vandenman.github.io/bgms/index.html","id":"bgms-bayesian-analysis-of-graphical-models","dir":"","previous_headings":"","what":"Bayesian variable selection for networks of binary and/or ordinal variables","title":"Bayesian variable selection for networks of binary and/or ordinal variables","text":"R package bgms provides tools Bayesian analysis graphical models describing networks variables. package uses Bayesian variable selection methods model underlying network structure. methods organized around two general approaches Bayesian variable selection: (1) EM variable selection (2) Gibbs variable selection. key distinction former uses continuous spike slab prior distribution pairwise interactions (Marsman et al. 2022) allows us use EM variable selection (Ročková George 2014). Gibbs variable selection approach (George McCulloch 1993), hand, stipulates discrete spike slab prior pairwise interactions, allows us set interactions exact zeroes. account discontinuity zero, embed Metropolis approach mixtures mutually singular distributions (Gottardo Raftery 2008) Gibbs sampler. goal provide tools Markov Random Field (MRF) models wide range variable types bgms package, currently provides analyzing networks binary /ordinal variables (Marsman Haslbeck 2023).","code":""},{"path":"https://vandenman.github.io/bgms/index.html","id":"why-use-markov-random-fields","dir":"","previous_headings":"","what":"Why use Markov Random Fields?","title":"Bayesian variable selection for networks of binary and/or ordinal variables","text":"Multivariate analysis using graphical models received much attention recent psychological psychometric literature (Robinaugh et al. 2020; Marsman Rhemtulla 2022; Steinley 2021; Contreras et al. 2019). graphical models Markov Random Field (MRF) models, whose graph structure reflects conditional associations variables (Kindermann Snell 1980). models, missing edge two variables network implies variables independent, given remaining variables (Lauritzen 2004). words, remaining variables network fully account potential association unconnected variables.","code":""},{"path":"https://vandenman.github.io/bgms/index.html","id":"why-use-a-bayesian-approach-to-analyze-the-mrf","dir":"","previous_headings":"","what":"Why use a Bayesian approach to analyze the MRF?","title":"Bayesian variable selection for networks of binary and/or ordinal variables","text":"Testing structure MRF requires us determine plausibility opposing hypotheses conditional dependence conditional independence. example, plausible network structures include edge variables 3 9 compared network structures exclude edge? Frequentist approaches limited respect, can reject conditional independence hypothesis, support (Wagenmakers et al. 2018; Wagenmakers 2007). creates problem , edge excluded, know whether edge absent population, lack power reject null hypothesis independence. avoid problem, use Bayesian approach using Bayes factors (Kass Raftery 1995). inclusion Bayes factor (Huth et al. 2023) allows us quantify much data support conditional dependence —evidence edge presence— conditional independence —evidence edge absence. also allows us conclude limited support either hypothesis (Dienes 2014) —absence evidence.","code":""},{"path":"https://vandenman.github.io/bgms/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian variable selection for networks of binary and/or ordinal variables","text":"current developmental version can installed ","code":"if (!requireNamespace(\"remotes\")) {    install.packages(\"remotes\")    }    remotes::install_github(\"MaartenMarsman/bgms\")"},{"path":[]},{"path":"https://vandenman.github.io/bgms/reference/Wenchuan.html","id":null,"dir":"Reference","previous_headings":"","what":"Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors — Wenchuan","title":"Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors — Wenchuan","text":"data set containing items measuring symptoms posttraumatic stress  disorder (PTSD) (McNally et al. 2015) . Participants 362  Chinese adults survived Wenchuan earthquake lost least one  child disaster. PTSD symptoms reported using civilian version  Posttraumatic Checklist, consists 17 items, assessing  one DSM-IV symptoms PTSD. Participants rated item  five-point scale ranging ``'' ``extremely'' indicate  much symptom bothered past month.","code":""},{"path":"https://vandenman.github.io/bgms/reference/Wenchuan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors — Wenchuan","text":"","code":"data(\"Wenchuan\")"},{"path":"https://vandenman.github.io/bgms/reference/Wenchuan.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors — Wenchuan","text":"matrix 362 rows 17 columns: intrusion Repeated, disturbing memories, thoughts, images    stressful experience past? dreams Repeated, disturbing dreams stressful experience    past? flash Suddenly acting feeling stressful experience    happening (reliving )? upset Feeling upset something reminded stressful    experience past? physior physical reactions (e.g., heart pounding, trouble    breathing, sweating) something reminded stressful experience    past? avoidth Avoiding thinking talking stressful    experience past avoiding feelings related ? avoidact Avoiding activities situations reminded    stressful experience past? amnesia Trouble remembering important parts stressful    experience past? lossint Loss interest activities used enjoy? distant Feeling distant cut people? numb Feeling emotionally numb unable loving    feelings close ? future Feeling future somehow cut short? sleep Trouble falling staying asleep? anger Feeling irritable angry outbursts? concen difficulty concentrating? hyper \"super-alert\" watchful guard? startle Feeling jumpy easily startled?","code":""},{"path":"https://vandenman.github.io/bgms/reference/Wenchuan.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors — Wenchuan","text":"http://psychosystems.org/wp-content/uploads/2014/10/Wenchuan.csv","code":""},{"path":"https://vandenman.github.io/bgms/reference/Wenchuan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors — Wenchuan","text":"McNally RJ, Robinaugh DJ, Wu GWY, Wang L, Deserno MK, Borsboom D (2015). “Mental disorders causal systems: network approach posttraumatic stress disorder.” Clinical Psychological Science, 5(6), 836--849. doi:10.1177/2167702614553230 .","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.em.html","id":null,"dir":"Reference","previous_headings":"","what":"EM variable selection for a Markov Random Field model for ordinal variables. — bgm.em","title":"EM variable selection for a Markov Random Field model for ordinal variables. — bgm.em","text":"function bgm.em selects promising edges ordinal MRF using joint pseudolikelihood continuous spike slab prior distribution stipulated MRF's interaction association parameters.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EM variable selection for a Markov Random Field model for ordinal variables. — bgm.em","text":"","code":"bgm.em(   x,   precision = 0.975,   convergence_criterion = sqrt(.Machine$double.eps),   theta = 0.5,   hierarchical = FALSE,   indicator_alpha = 1,   indicator_beta = 1,   maximum_iterations = 1000,   threshold_alpha = 1,   threshold_beta = 1 )"},{"path":"https://vandenman.github.io/bgms/reference/bgm.em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"EM variable selection for a Markov Random Field model for ordinal variables. — bgm.em","text":"x no_persons no_nodes matrix containing categories coded non-negative integers (.e., coded 0, 1, ..., no_categories) no_persons independent observations no_nodes variables network graph. precision number zero one. prior precision desired edge selection. Equal one minus desired type-1 error. Defaults .975. convergence_criterion convergence criterion pseudoposterior values EM algorithm. Defaults sqrt(.Machine$double.eps). theta prior inclusion probability. value theta = 0.5, combination hierarchical = FALSE stipulates uniform prior space network structures. hierarchical Logical. TRUE, beta prior distribution imposed prior inclusion probability theta hyperparameters alpha beta. uniform prior inclusion probability, beta alpha = beta = 1, stipulates uniform prior network structure complexity. indicator_alpha, indicator_beta hyperparameters beta prior distribution stipulated prior inclusion probability theta hierarchical = TRUE. Default 1. maximum_iterations maximum number EM iterations used. Defaults 1e3. warning issued procedure converged maximum_iterations iterations. threshold_alpha, threshold_beta shape parameters Beta-prime prior thresholds. Defaults 1.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"EM variable selection for a Markov Random Field model for ordinal variables. — bgm.em","text":"list containing no_nodes no_nodes matrices  interactions gamma, no_nodes  no_categories matrix thresholds, ,  hierarchical == TRUE, numeric valued theta. matrix  interactions numeric matrix pairwise   association estimates -diagonal elements. matrix gamma contains expected values edge inclusion variables (.e., local   posterior probability edge inclusion. matrix thresholds contains category thresholds per node. hierarchical = TRUE,   modal estimate prior inclusion probability theta also   provided.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.em.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"EM variable selection for a Markov Random Field model for ordinal variables. — bgm.em","text":"","code":"if (FALSE) {  ##Analyse the Wenchuan dataset  fit = bgm.em(x = Wenchuan)    #------------------------------------------------------------------------------|  # INCLUSION - EDGE WEIGHT PLOT  #------------------------------------------------------------------------------|   par(mar = c(6, 5, 1, 1))  plot(x = fit$interactions[lower.tri(fit$interactions)],       y = fit$gamma[lower.tri(fit$gamma)], ylim = c(0, 1),       xlab = \"\", ylab = \"\", axes = FALSE, pch = 21, bg = \"#bfbfbf\", cex = 1.3)  abline(h = 0, lty = 2, col = \"#bfbfbf\")  abline(h = 1, lty = 2, col = \"#bfbfbf\")  abline(h = .5, lty = 2, col = \"#bfbfbf\")  mtext(\"Posterior Inclusion Probability\", side = 1, line = 3, cex = 1.7)  mtext(\"Posterior Mode Edge Weight\", side = 2, line = 3, cex = 1.7)  axis(1)  axis(2, las = 1)    #------------------------------------------------------------------------------|  # THE LOCAL MEDIAN PROBABILITY NETWORK  #------------------------------------------------------------------------------|   library(qgraph) #For plotting the estimated network   posterior.inclusion = fit$gamma[lower.tri(fit$gamma)]  tmp = fit$interactions[lower.tri(fit$interactions)]  tmp[posterior.inclusion < 0.5] = 0   median.prob.model = matrix(0, nrow = ncol(Wenchuan), ncol = ncol(Wenchuan))  median.prob.model[lower.tri(median.prob.model)] = tmp  median.prob.model = median.prob.model + t(median.prob.model)   rownames(median.prob.model) = colnames(Wenchuan)  colnames(median.prob.model) = colnames(Wenchuan)   qgraph(median.prob.model,         theme = \"TeamFortress\",         maximum = .5,         fade = FALSE,         color = c(\"#f0ae0e\"), vsize = 10, repulsion = .9,         label.cex = 1.1, label.scale = \"FALSE\",         labels = colnames(Wenchuan)) }"},{"path":"https://vandenman.github.io/bgms/reference/bgm.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","title":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","text":"function bgm explores joint pseudoposterior distribution structures parameters Markov Random Field mixed binary ordinal variables.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","text":"","code":"bgm(   x,   iter = 10000,   burnin = 1000,   interaction_prior = c(\"UnitInfo\", \"Cauchy\"),   cauchy_scale = 2.5,   threshold_alpha = 1,   threshold_beta = 1,   save = FALSE,   display_progress = TRUE )"},{"path":"https://vandenman.github.io/bgms/reference/bgm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","text":"x n p matrix containing binary ordinal variables n independent observations p variables network graph. done already, bgms recodes variables non-negative integers (.e., 0, 1, ..., m). Unobserved categories collapsed categories recoding. See reformat_data details. iter number iterations Gibbs sampler. Defaults 1e4. usually gives good idea. good estimates recommended run procedure 1e5 iterations. burnin number burnin iterations. output Gibbs sampler stored burnin iterations. interaction_prior prior distribution interaction effects. Currently, two prior densities implemented: Unit Information prior (interaction_prior = \"UnitInfo\") Cauchy prior (interaction_prior = \"Cauchy\"). Defaults \"UnitInfo\". cauchy_scale scale Cauchy prior interactions. Defaults 2.5. threshold_alpha, threshold_beta shape parameters Beta-prime prior thresholds. Defaults 1. save function collect return samples Gibbs sampler (save = TRUE)? return (model-averaged) posterior means (save = FALSE)? Defaults FALSE. display_progress function show progress bar (display_progress = TRUE)? (display_progress = FALSE)? Defauls TRUE.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","text":"save = FALSE (default), list containing p p matrices gamma interactions, p max(no_categories) matrix thresholds. matrix gamma numeric matrix contains inclusion probabilities individual edges. matrices interactions thresholds numeric matrices contain (model structure-averaged) posterior means (EAP estimates) pairwise associations, category thresholds, respectively. save = TRUE, list containing iter p *  (p - 1) / 2 matrices samples.gamma samples.interactions, iter sum(no_categories) matrix samples.thresholds. contain parameter states every iteration Gibbs sampler. Column averages offer EAP estimates.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","text":"discrete spike slab prior distribution stipulated pairwise interactions. formulating mixture mutually singular distributions, function can use combination Metropolis-Hastings Gibbs sampling create Markov chain joint posterior distribution invariant. Current options slab distribution unit-information prior Cauchy optional scaling parameter. Beta-prime distribution used exponent category parameters. uniform prior used edge inclusion variables (.e., prior probability edge included 0.5).","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian structure learning in Markov Random Fields of mixed binary and\nordinal variables using MCMC. — bgm","text":"","code":"if (FALSE) {  ##Analyse the Wenchuan dataset   # Here, we use 1e4 iterations, for an actual analysis please use at least  # 1e5 iterations.  fit = bgm(x = Wenchuan)    #------------------------------------------------------------------------------|  # INCLUSION - EDGE WEIGHT PLOT  #------------------------------------------------------------------------------|   par(mar = c(6, 5, 1, 1))  plot(x = fit$interactions[lower.tri(fit$interactions)],       y = fit$gamma[lower.tri(fit$gamma)], ylim = c(0, 1),       xlab = \"\", ylab = \"\", axes = FALSE, pch = 21, bg = \"gray\", cex = 1.3)  abline(h = 0, lty = 2, col = \"gray\")  abline(h = 1, lty = 2, col = \"gray\")  abline(h = .5, lty = 2, col = \"gray\")  mtext(\"Posterior Inclusion Probability\", side = 1, line = 3, cex = 1.7)  mtext(\"Posterior Mode Edge Weight\", side = 2, line = 3, cex = 1.7)  axis(1)  axis(2, las = 1)    #------------------------------------------------------------------------------|  # EVIDENCE - EDGE WEIGHT PLOT  #------------------------------------------------------------------------------|   #The bgms package currently assumes that the prior odds are 1:  prior.odds = 1  posterior.inclusion = fit$gamma[lower.tri(fit$gamma)]  posterior.odds = posterior.inclusion / (1 - posterior.inclusion)  log.bayesfactor = log(posterior.odds / prior.odds)  log.bayesfactor[log.bayesfactor > 5] = 5   par(mar = c(5, 5, 1, 1) + 0.1)  plot(fit$interactions[lower.tri(fit$interactions)], log.bayesfactor, pch = 21, bg = \"#bfbfbf\",       cex = 1.3, axes = FALSE, xlab = \"\", ylab = \"\", ylim = c(-5, 5.5),       xlim = c(-0.5, 1.5))  axis(1)  axis(2, las = 1)  abline(h = log(1/10), lwd = 2, col = \"#bfbfbf\")  abline(h = log(10), lwd = 2, col = \"#bfbfbf\")   text(x = 1, y = log(1 / 10), labels = \"Evidence for Exclusion\", pos = 1,       cex = 1.7)  text(x = 1, y = log(10), labels = \"Evidence for Inclusion\", pos = 3, cex = 1.7)  text(x = 1, y = 0, labels = \"Absence of Evidence\", cex = 1.7)  mtext(\"Log-Inclusion Bayes Factor\", side = 2, line = 3, cex = 1.5, las = 0)  mtext(\"Posterior Mean Interactions \", side = 1, line = 3.7, cex = 1.5, las = 0)    #------------------------------------------------------------------------------|  # THE LOCAL MEDIAN PROBABILITY NETWORK  #------------------------------------------------------------------------------|   tmp = fit$interactions[lower.tri(fit$interactions)]  tmp[posterior.inclusion < 0.5] = 0   median.prob.model = matrix(0, nrow = ncol(Wenchuan), ncol = ncol(Wenchuan))  median.prob.model[lower.tri(median.prob.model)] = tmp  median.prob.model = median.prob.model + t(median.prob.model)   rownames(median.prob.model) = colnames(Wenchuan)  colnames(median.prob.model) = colnames(Wenchuan)   library(qgraph)  qgraph(median.prob.model,         theme = \"TeamFortress\",         maximum = .5,         fade = FALSE,         color = c(\"#f0ae0e\"), vsize = 10, repulsion = .9,         label.cex = 1.1, label.scale = \"FALSE\",         labels = colnames(Wenchuan))  }"},{"path":"https://vandenman.github.io/bgms/reference/bgms-package.html","id":null,"dir":"Reference","previous_headings":"","what":"bgms: Bayesian Analysis of Graphical Models — bgms-package","title":"bgms: Bayesian Analysis of Graphical Models — bgms-package","text":"R package bgms provides tools Bayesian analysis graphical models describing networks variables. package uses Bayesian variable selection methods model underlying network structure. package organized around two Bayesian variable selection approaches: (1) EM variable selection, (2) Gibbs variable selection. key distinction former uses continuous spike slab prior distribution pairwise interactions (Marsman et al. 2022)  allows us use EM variable selection (Ročková George 2014) . Gibbs variable selection approach (George McCulloch 1993) , hand, stipulates discrete spike slab prior pairwise interactions, allows us set interactions exact zeroes. account discontinuity zero, embed Metropolis approach mixtures mutually singular distributions (Gottardo Raftery 2008)  Gibbs sampler. goal provide tools Markov Random Field (MRF) models wide range variable types bgms package, currently provides tools analyzing networks binary /ordinal variables (Marsman Haslbeck 2023) . MRFs special class graphical models whose graph structure reflects conditional associations variables. Bayes factor tests inclusion exclusion edge MRF thus compare conditional dependence conditional independence hypotheses corresponding network variables (Huth et al. 2023) . bgms package offers several tools analyzing structure MRF: Simulate response data MRF using Gibbs sampler. Simulate mrfSampler. Estimate structure MRF using EM variable selection. Network estimation bgm.em. Estimate posterior distribution MRF's network structure  using Gibbs variable selection. Structure learning bgm. Additional Features: Optimizing joint pseudolikelihood mple. Optimizing joint pseudoposterior mppe.","code":""},{"path":"https://vandenman.github.io/bgms/reference/bgms-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"bgms: Bayesian Analysis of Graphical Models — bgms-package","text":"George EI, McCulloch RE (1993). “Variable selection via Gibbs sampling.” Journal American Statistical Association, 88(423), 881-889. doi:10.1080/01621459.1993.10476353 . Gottardo R, Raftery AE (2008). “Markov Chain Monte Carlo Mixtures Mutually Singular Distributions.” Journal Computational Graphical Statistics, 17(4), 949--975. doi:10.1198/106186008X386102 . Huth K, de Ron J, Goudriaan AE, Luigjes K, Mohammadi R, van Holst RJ, Wagenmakers E, Marsman M (2023). “Bayesian analysis cross-sectional networks: tutorial R JASP.” PsyArXiv. doi:10.31234/osf.io/ub5tc . Marsman M, Haslbeck JMB (2023). “Bayesian analysis ordinal Markov Random Field.” PsyArXiv. doi:10.31234/osf.io/ukwrf . Marsman M, Huth KBS, Waldorp LJ, Ntzoufras (2022). “Objective Bayesian edge screening structure selection Ising networks.” Psychometrika, 87(1), 47--82. doi:10.1007/s11336-022-09848-8 . Ročková V, George EI (2014). “EMVS: EM approach Bayesian variable selection.” Journal American Statistical Association, 109(506), 828--846. doi:10.1080/01621459.2013.869223 .","code":""},{"path":"https://vandenman.github.io/bgms/reference/mple.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum Pseudolikelihood estimation for a Markov Random Field model for\nordinal variables. — mple","title":"Maximum Pseudolikelihood estimation for a Markov Random Field model for\nordinal variables. — mple","text":"function mple estimates parameters ordinal MRF optimizing joint pseudolikelihood Newton-Raphson.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum Pseudolikelihood estimation for a Markov Random Field model for\nordinal variables. — mple","text":"","code":"mple(   x,   no_categories,   convergence_criterion = sqrt(.Machine$double.eps),   maximum_iterations = 1000,   thresholds,   interactions )"},{"path":"https://vandenman.github.io/bgms/reference/mple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum Pseudolikelihood estimation for a Markov Random Field model for\nordinal variables. — mple","text":"x no_persons no_nodes matrix containing categories coded non-negative integers (.e., coded 0, 1, ..., no_categories) no_persons independent observations no_nodes variables network graph. no_categories maximum category. convergence_criterion convergence criterion pseudoposterior values EM algorithm. Defaults sqrt(.Machine$double.eps). maximum_iterations maximum number EM iterations used. Defaults 1e3. warning issued procedure converged maximum_iterations iterations. thresholds no_nodes no_categories matrix thresholds. Used starting values Newton-Raphson procedure. Optional. interactions no_nodes no_nodes matrices interactions. Used starting values Newton-Raphson procedure. Optional.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum Pseudolikelihood estimation for a Markov Random Field model for\nordinal variables. — mple","text":"list containing no_nodes no_nodes matrices interactions no_nodes no_categories matrix thresholds. matrix interactions numeric matrix contains maximum pseudolikelihood estimates pairwise association parameters. matrix thresholds contains maximum pseudolikelihood estimates category thresholds parameters.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mppe.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimization of the Pseudoposterior for a Markov Random Field model for\nordinal variables. — mppe","title":"Optimization of the Pseudoposterior for a Markov Random Field model for\nordinal variables. — mppe","text":"function mppe estimates parameters ordinal MRF optimizing pseudoposterior Newton-Raphson.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mppe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimization of the Pseudoposterior for a Markov Random Field model for\nordinal variables. — mppe","text":"","code":"mppe(   x,   no_categories,   interaction_prior = \"Cauchy\",   cauchy_scale = 2.5,   threshold_alpha = 1,   threshold_beta = 1,   convergence_criterion = sqrt(.Machine$double.eps),   maximum_iterations = 1000,   thresholds,   interactions )"},{"path":"https://vandenman.github.io/bgms/reference/mppe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimization of the Pseudoposterior for a Markov Random Field model for\nordinal variables. — mppe","text":"x no_persons no_nodes matrix containing categories coded non-negative integers (.e., coded 0, 1, ..., no_categories) no_persons independent observations no_nodes variables network graph. no_categories maximum category. interaction_prior prior distribution interaction effects. Currently, two prior densities implemented: Unit Information prior (interaction_prior = \"UnitInfo\") Cauchy prior (interaction_prior = \"Cauchy\"). Defaults \"Cauchy\". cauchy_scale scale Cauchy prior interactions. Defaults 2.5. threshold_alpha, threshold_beta shape parameters Beta-prime prior thresholds. Default 1. convergence_criterion convergence criterion pseudoposterior values EM algorithm. Defaults sqrt(.Machine$double.eps). maximum_iterations maximum number EM iterations used. Defaults 1e3. warning issued procedure converged maximum_iterations iterations. thresholds no_nodes no_categories matrix thresholds. Used starting values Newton-Raphson procedure. Optional. interactions no_nodes no_nodes matrices interactions. Used starting values Newton-Raphson procedure. Optional.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mppe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimization of the Pseudoposterior for a Markov Random Field model for\nordinal variables. — mppe","text":"list containing no_nodes no_nodes matrices interactions, no_nodes no_categories matrix thresholds, hessian matrix computed final iteration optimization procedure, , case interaction_prior = \"UnitInfo\", no_nodes no_nodes matrix unit_info. matrix interactions numeric matrix contains maximum pseudoposterior estimates pairwise associations. matrix thresholds contains maximum pseudoposterior estimates category thresholds parameters. hessian matrix dimensions equal number thresholds + associations. topleft square contains thresholds, bottomright square associations (form (1,2), (1, 3), ..., (2, 1), ...). unit_information matrix contains variances unit information prior association effects.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mrfSampler.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample states of the ordinal MRF — mrfSampler","title":"Sample states of the ordinal MRF — mrfSampler","text":"function samples states ordinal MRF using Gibbs sampler. Gibbs sampler initiated random values response options, proceeds simulating states node logistic model using node states predictor variables.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mrfSampler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample states of the ordinal MRF — mrfSampler","text":"","code":"mrfSampler(   no_states,   no_nodes,   no_categories,   interactions,   thresholds,   iter = 1000 )"},{"path":"https://vandenman.github.io/bgms/reference/mrfSampler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample states of the ordinal MRF — mrfSampler","text":"no_states number states ordinal MRF generated. no_nodes number nodes ordinal MRF. no_categories Either positive integer vector positive integers length no_nodes. number response categories top base category: no_categories = 1 generates binary states. interactions symmetric no_nodes no_nodes matrix pairwise interactions. -diagonal elements used. thresholds no_nodes max(no_categories) matrix category thresholds. elements row r indicate thresholds node r. no_categories vector, first no_categories[r] elements used row r. iter number iterations used Gibbs sampler. function provides last state Gibbs sampler output. default set 1e3.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mrfSampler.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample states of the ordinal MRF — mrfSampler","text":"no_states no_nodes matrix simulated states ordinal MRF.","code":""},{"path":"https://vandenman.github.io/bgms/reference/mrfSampler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample states of the ordinal MRF — mrfSampler","text":"","code":"# Generate responses from a network of five binary and ordinal variables. no_nodes = 5 no_categories = sample(1:5, size = no_nodes, replace = TRUE)  Interactions = matrix(0, nrow = no_nodes, ncol = no_nodes) Interactions[2, 1] = Interactions[4, 1] = Interactions[3, 2] =   Interactions[5, 2] = Interactions[5, 4] = .25 Interactions = Interactions + t(Interactions) Thresholds = matrix(0, nrow = no_nodes, ncol = max(no_categories)) x = mrfSampler(no_states = 1e3,                no_nodes = no_nodes,                no_categories = no_categories,                interactions = Interactions,                thresholds = Thresholds)"}]
