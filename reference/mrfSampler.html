<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sample observations from the ordinal MRF — mrfSampler • bgms</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample observations from the ordinal MRF — mrfSampler"><meta name="description" content="This function samples states from the ordinal MRF using a Gibbs sampler. The
Gibbs sampler is initiated with random values from the response options,
after which it proceeds by simulating states for each variable from a logistic
model using the other variable states as predictor variables."><meta property="og:description" content="This function samples states from the ordinal MRF using a Gibbs sampler. The
Gibbs sampler is initiated with random values from the response options,
after which it proceeds by simulating states for each variable from a logistic
model using the other variable states as predictor variables."></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bgms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Bayesian analysis of networks of binary and/or ordinal variables using the bgm function</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MaartenMarsman/bgms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample observations from the ordinal MRF</h1>
      <small class="dont-index">Source: <a href="https://github.com/MaartenMarsman/bgms/blob/main/R/sampleMRF.R" class="external-link"><code>R/sampleMRF.R</code></a></small>
      <div class="d-none name"><code>mrfSampler.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function samples states from the ordinal MRF using a Gibbs sampler. The
Gibbs sampler is initiated with random values from the response options,
after which it proceeds by simulating states for each variable from a logistic
model using the other variable states as predictor variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mrfSampler</span><span class="op">(</span></span>
<span>  <span class="va">no_states</span>,</span>
<span>  <span class="va">no_variables</span>,</span>
<span>  <span class="va">no_categories</span>,</span>
<span>  <span class="va">interactions</span>,</span>
<span>  <span class="va">thresholds</span>,</span>
<span>  variable_type <span class="op">=</span> <span class="st">"ordinal"</span>,</span>
<span>  <span class="va">reference_category</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-no-states">no_states<a class="anchor" aria-label="anchor" href="#arg-no-states"></a></dt>
<dd><p>The number of states of the ordinal MRF to be generated.</p></dd>


<dt id="arg-no-variables">no_variables<a class="anchor" aria-label="anchor" href="#arg-no-variables"></a></dt>
<dd><p>The number of variables in the ordinal MRF.</p></dd>


<dt id="arg-no-categories">no_categories<a class="anchor" aria-label="anchor" href="#arg-no-categories"></a></dt>
<dd><p>Either a positive integer or a vector of positive
integers of length <code>no_variables</code>. The number of response categories on top
of the base category: <code>no_categories = 1</code> generates binary states.</p></dd>


<dt id="arg-interactions">interactions<a class="anchor" aria-label="anchor" href="#arg-interactions"></a></dt>
<dd><p>A symmetric <code>no_variables</code> by <code>no_variables</code> matrix of
pairwise interactions. Only its off-diagonal elements are used.</p></dd>


<dt id="arg-thresholds">thresholds<a class="anchor" aria-label="anchor" href="#arg-thresholds"></a></dt>
<dd><p>A <code>no_variables</code> by <code>max(no_categories)</code> matrix of
category thresholds. The elements in row <code>i</code> indicate the thresholds of
variable <code>i</code>. If <code>no_categories</code> is a vector, only the first
<code>no_categories[i]</code> elements are used in row <code>i</code>. If the Blume-Capel
model is used for the category thresholds for variable <code>i</code>, then row
<code>i</code> requires two values (details below); the first is
\(\alpha\), the linear contribution of the Blume-Capel model and
the second is \(\beta\), the quadratic contribution.</p></dd>


<dt id="arg-variable-type">variable_type<a class="anchor" aria-label="anchor" href="#arg-variable-type"></a></dt>
<dd><p>What kind of variables are simulated? Can be a single
character string specifying the variable type of all <code>p</code> variables at
once or a vector of character strings of length <code>p</code> specifying the type
for each variable separately. Currently, bgm supports “ordinal” and
“blume-capel”. Binary variables are automatically treated as “ordinal’’.
Defaults to <code>variable_type = "ordinal"</code>.</p></dd>


<dt id="arg-reference-category">reference_category<a class="anchor" aria-label="anchor" href="#arg-reference-category"></a></dt>
<dd><p>An integer vector of length <code>no_variables</code> specifying the
reference_category category that is used for the Blume-Capel model (details below).
Can be any integer value between <code>0</code> and <code>no_categories</code> (or
<code>no_categories[i]</code>).</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>The number of iterations used by the Gibbs sampler.
The function provides the last state of the Gibbs sampler as output. By
default set to <code>1e3</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>no_states</code> by <code>no_variables</code> matrix of simulated states of
the ordinal MRF.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are two modeling options for the category thresholds. The default
option assumes that the category thresholds are free, except that the first
threshold is set to zero for identification. The user then only needs to
specify the thresholds for the remaining response categories. This option is
useful for any type of ordinal variable and gives the user the most freedom
in specifying their model.</p>
<p>The Blume-Capel option is specifically designed for ordinal variables that
have a special type of reference_category category, such as the neutral
category in a Likert scale. The Blume-Capel model specifies the following
quadratic model for the threshold parameters:
$$\mu_{\text{c}} = \alpha \times \text{c} + \beta \times (\text{c} - \text{r})^2,$$
where \(\mu_{\text{c}}\) is the threshold for category c
(which now includes zero), \(\alpha\) offers a linear trend
across categories (increasing threshold values if
\(\alpha &gt; 0\) and decreasing threshold values if
\(\alpha &lt;0\)), if \(\beta &lt; 0\), it offers an
increasing penalty for responding in a category further away from the
reference_category category r, while \(\beta &gt; 0\) suggests a
preference for responding in the reference_category category.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate responses from a network of five binary and ordinal variables.</span></span></span>
<span class="r-in"><span><span class="va">no_variables</span> <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">no_categories</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, size <span class="op">=</span> <span class="va">no_variables</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Interactions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">no_variables</span>, ncol <span class="op">=</span> <span class="va">no_variables</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Interactions</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">Interactions</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">Interactions</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span></span></span>
<span class="r-in"><span>  <span class="va">Interactions</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="va">Interactions</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="fl">.25</span></span></span>
<span class="r-in"><span><span class="va">Interactions</span> <span class="op">=</span> <span class="va">Interactions</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Interactions</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Thresholds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">no_variables</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">no_categories</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu">mrfSampler</span><span class="op">(</span>no_states <span class="op">=</span> <span class="fl">1e3</span>,</span></span>
<span class="r-in"><span>               no_variables <span class="op">=</span> <span class="va">no_variables</span>,</span></span>
<span class="r-in"><span>               no_categories <span class="op">=</span> <span class="va">no_categories</span>,</span></span>
<span class="r-in"><span>               interactions <span class="op">=</span> <span class="va">Interactions</span>,</span></span>
<span class="r-in"><span>               thresholds <span class="op">=</span> <span class="va">Thresholds</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The matrix ``thresholds'' contains numeric values for variable 3 for category </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (categories, i.e., columns) exceding the maximum of 1. These values will </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> be ignored.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The matrix ``thresholds'' contains numeric values for variable 4 for category </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (categories, i.e., columns) exceding the maximum of 2. These values will </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> be ignored.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate responses from a network of 2 ordinal and 3 Blume-Capel variables.</span></span></span>
<span class="r-in"><span><span class="va">no_variables</span> <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">no_categories</span> <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Interactions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">no_variables</span>, ncol <span class="op">=</span> <span class="va">no_variables</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Interactions</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">Interactions</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">Interactions</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span></span></span>
<span class="r-in"><span>  <span class="va">Interactions</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="va">Interactions</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="fl">.25</span></span></span>
<span class="r-in"><span><span class="va">Interactions</span> <span class="op">=</span> <span class="va">Interactions</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Interactions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Thresholds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">no_variables</span>, <span class="va">no_categories</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Thresholds</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">Thresholds</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">Thresholds</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Thresholds</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu">mrfSampler</span><span class="op">(</span>no_states <span class="op">=</span> <span class="fl">1e3</span>,</span></span>
<span class="r-in"><span>               no_variables <span class="op">=</span> <span class="va">no_variables</span>,</span></span>
<span class="r-in"><span>               no_categories <span class="op">=</span> <span class="va">no_categories</span>,</span></span>
<span class="r-in"><span>               interactions <span class="op">=</span> <span class="va">Interactions</span>,</span></span>
<span class="r-in"><span>               thresholds <span class="op">=</span> <span class="va">Thresholds</span>,</span></span>
<span class="r-in"><span>               variable_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>,<span class="st">"b"</span>,<span class="st">"o"</span>,<span class="st">"b"</span>,<span class="st">"o"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               reference_category <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Maarten Marsman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

